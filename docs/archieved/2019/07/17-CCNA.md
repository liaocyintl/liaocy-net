---
title: CCNA試験のまとめノート 08 ルーティング基礎
date: 2019-07-17 11:00
lang: ja
tags:
    - ノート
    
categories: 
    - 資格試験
    - CCNA
    
---
ルーティング、スタティックルーティング、ダイナミックルーティング、経路集約、メトリックとアドミニストレーティブディスタンス
<!-- more -->

# ルーティング
- 定義：パケットを宛先ホストに届けるために最適な経路を選択して伝送するプロセス
- ルーティングテーブル：受信したパケットの伝送先を
- ルーティングテーブルの学習方法
  - 直接接続ルート：
  - スタティックルート
  - ダイナミックルート
- ルーティングテーブルの表示
```
#show ip route
```
# スタティックルート
- 定義：管理者が手動で設定した経路情報
- 特徴：他のルータに通知しなく、帯域を消費せず、ルータの負荷を最小限に
- 使う場合：
  - メモリCPU制限あり
  - スタブネットワーク、
    - Stub Network（存根网络; 末节网络; 末端网络; ）、外部ネットワークへの接続が一つしかない端末のネットワーク
  - デフォルトルート
  - 宛先はのダイナミックルートがない場合
  - ISPから顧客の内部ネットワークへの経路が必要な場合
  - ルーティングプロトコルの適用が困難の場合
  - ダイヤルアップ接続の場合
    - dial-up: 電話回線を使ってインタネットや社内LANに接続する。
- スタティックルートの設定
    - Administrative distance: RIPによるダイナミックルートとして受信しているとします。このような場合には、ルータは信頼度の高いルーティングプロトコルからの情報だけをルーティングテーブルに登録します。この信頼度を決めるための値がアドミニストレーティブディスタンス。

```
(config)# ip route <address> <mask> {<next-hop>|<interface>} [<distance>][permanent]

.address ... 宛先IPアドレス
.mask ... 宛先ネットマック
.next-hop ... 次のルータのIPアドレス
.interface ... 宛先に行くため使うインターフェース
.distance ... アドミニストレーティブディスタンス値、デフォルトは１
.permanent ... インターフェースがダウンしても、経路情報がルーティングテーブルから削除されないようにするときに指定

```

- デフォルトルート
  - 定義：ルーティングテーブルに明示的に登録されいないネットワーク宛のパケットを伝送する際に使用する経路情報
  - 利点：ルーティングテーブルが小さくすることができる
  - 使う場合：
    - メモリやCPUに制限がある
    - 支社から本社へのルーティング
    - スタブネットワークのルータ
    - インターネット接続をしているルータ
    - インターネット接続をしているルータ
    - 特定なネットワークを学習することが望ましくないトポロジ
  - 設定：

```
(config)#ip route 0.0.0.0 0.0.0.0 {<next-hop>|<interface>}

.宛先アドレスとマスクを0.0.0.0に指定

```

- ロンゲストマッチ（longest match 最長一致）
  - 定義：ルーティングテーブルに宛先ネットワークアドレス複数存在の場合、宛先ネットワークアドレスと一致するビットの並びが先頭から最も長い経路情報を選択する。
  - 注意：ネットワーク部は完全に一致する必要

# ダイナミックルーティング
## ダイナミックルート
- 定義：ルーティングプロトコルによって動的にルーティングテーブルに学習される経路
- 特徴：トポロジに変更があった場合、変更情報をルータ間で通知し合ってルーティングテーブルを更新
- 利点：管理者の負荷を削減、大きなネットワークでは特に効果的
- 欠点：メモリとCPUへ負荷がかかる。帯域幅を消費。専門知識がいる
## ルーティングプロトコルの種類
- IGP(Interior [ɪnˈtɪriər] n. 内部 Gateway Protocol)
  - 場合：AS内のルーティングに使用する
  - 分類：
    - ディスタンスベクター(Distance Vector 距离向量)型
      - distance：ホップ数、経由したルータ数
      - vector：ネクストホップ（next hop, 下一跳）
      - プロトコル：
        - RIP (Routing Information Protocol: UDP/IP): ホップ数を基に宛先ネットワークの最適経路を判断し、比較的小規模なネットワークで使用される。
        - IGRP(Interior Gateway Routing Protocol): シスコ独自、メトリックに帯域幅を使用、定期的にブロードキャストでルーティングテーブルを送信。
        - EIGRP：IGRPの拡張版
    - リンクステート(Link State 链路状态)
      - 特徴：各ルートが持つインターフェースのリンク（Link）の状態（State）を交換し、
      - SPF(Shortest Path First)アルゴリズム：リンクステート型ルーティングプロトコルにおいて、各ルータがLSDB(Link State Database)を基に最短パスを算出するためのアルゴリズム。
      - プロトコル：
        - OSPF（Open Shortest Path First: TCP/IP）: 大規模ネットワークでも利用可、メトリック【metric】はコストを使う
        - IS-IS (Intermediate System to Intermediate System): ほとんど使用されていない
- EGP(Exterior [ɪnˈtɪriər] n. 内部 Gateway Protocol)
  - 場合：AS間でのルーティングに使用する
  - 略
- クラスフルルーティング
  - 特徴：ルーティングアップデートにサブネットマスク情報を加えない
  - プロトコル：RIPv1、IGRP
  - クラスフルネットワーク：クラスA・B・Cに基にしたネットワークアドレス
- クラスレスルーティング
  - 特徴：サブネットマスクを含む
  - プロトコル：RIPv2、EIGRP、OSPF、IS-IS

# 経路集約
## 経路集約とは
- 概念：ルーティングテーブルに学習された複数のネットワークアドレスを１つにまとめること
- 別名：ルートアグリケーション、スーパーネッティング
- 利点：
  - ルーティングテーブルのサイズを縮小、メモリ使用量とルーティングプロトコルのトラフィック量を削減
  - 特定サブネットがダウンしたとき、集約アドレスしか持たないルータへ通知する必要がない。トポロジ変更時に影響が及ぶ範囲を小さくできる。

## 経路集約の方法
- 連続するネットワークアドレスを2進数にしたとき、上位ビットの並びが共通する部分まで１つのアドレスに集約する。
- 例：172.16.9.9/24～172.16.31.0/24は、上位の19ビットが共通するため、172.16.0.0/19に集約する。

## ルーティングプロトコルによる経路集約
- クラスフルルーティングプロトコルの経路集約
  - クラスフルネットワークの境界で経路情報をクラス単位に自動集約
- クラスレスルーティングプロトコルの経路集約
  - 管理者によって手動で経路集約を行う

# メトリックとアドミニストレーティブディスタンス
## メトリック
- メトリック：各ルーティングプロトコルは最適経路を決定するための経路
- ホップカウント：RIPv1、RIPv2
- コスト：OSPF
- 帯域幅、遅延：EIGRP

## アドミニストレーティブディスタンス
- 範囲：0～255
- 値が小さいほど優先度が高い
- プロトコルによってAD値が違ってる
  - 直接接続：０
  - スタティックルート：１
  - EIGRP集約：５
  - EBGP：２０
  - EIGRP：９０
  - OSPF:１１０
  - IS-IS：１１５
  - RIPv1、RIPv2：１２０
  - EIGRP：１７０
  - IBGP：２００
  - 不明：２５５