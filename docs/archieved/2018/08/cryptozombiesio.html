<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-archieved/2018/08/cryptozombiesio">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<title data-rh="true">cryptozombies.io Solidity 代码注释笔记 | Jackie Liao</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://liaocy.net/liaocy-net/docs/archieved/2018/08/cryptozombiesio"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="cryptozombies.io Solidity 代码注释笔记 | Jackie Liao"><meta data-rh="true" name="description" content="参考资料"><meta data-rh="true" property="og:description" content="参考资料"><link data-rh="true" rel="icon" href="/liaocy-net/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://liaocy.net/liaocy-net/docs/archieved/2018/08/cryptozombiesio"><link data-rh="true" rel="alternate" href="https://liaocy.net/liaocy-net/docs/archieved/2018/08/cryptozombiesio" hreflang="en"><link data-rh="true" rel="alternate" href="https://liaocy.net/liaocy-net/docs/archieved/2018/08/cryptozombiesio" hreflang="x-default"><link rel="stylesheet" href="/liaocy-net/assets/css/styles.4e2cebda.css">
<link rel="preload" href="/liaocy-net/assets/js/runtime~main.90d75dde.js" as="script">
<link rel="preload" href="/liaocy-net/assets/js/main.83645087.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/liaocy-net/"><b class="navbar__title text--truncate">Jackie Liao</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/liaocy-net/docs">DOCS</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/liaocyintl/liaocy-net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub Repo"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/liaocy-net/docs">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/liaocy-net/docs/category/archieved">Archieved</a><button aria-label="Toggle the collapsible sidebar category &#x27;Archieved&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/liaocy-net/docs/archieved/2018/mostsimpleletsencrypt">2018</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/mostsimpleletsencrypt">在Ubuntu下使用Let&#x27;s Encrypt对Apache进行免费HTTPS加密的最简便方法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/privatedomain">在Hexo + GithubPage中使用个人域名</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/wslslow">Win10 Linux 子系统(WSL)缓慢及卡顿的解决方法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/voronoi">求若干坐标点最近邻区间分界线:用Python计算Voronoi图</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/markdownimage">使用Brainjet 系列 IDE (PyCharm, PHPStorm, WebStorm)编写Markdown文档，直接粘贴图片的方法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/phpexportdatatableexcel">使用PHPExcel将Wordpress数据库中的某个表导出成Excel表格并下载</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/phpimportexcel">使用PHPExcel导入Excel数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/lcypytools">一个我常用的Python工具包</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/mqttclient">Python实现MQTT接收订阅数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/yamlvalidator">Hexo下Next主题生成静态文件时报错no such file or directory, open themes\next\layout\_scripts\schemes\.swig</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/wordpressantisqlinjection">Wordpress的wpdb查询时防止SQL注入的方法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/selectrecordsfromlast24hours">MySQL查询24小时内记录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/pythondatetimetimezone">Python 初始化 datetime.datetime 时设置时区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/djangoonapache">在Ubuntu服务器上使用Apache2部署Django应用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/pregnantjapanese">怀孕日语词汇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/detaileditdistance">一个可以输出具体变化字符的编辑距离改进算法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/websegment">一种网页分割算法 Web Segment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/ubuntureboottoterminal">Ubuntu 18.04 LTS 设置为默认启动命令行模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/ubuntuwindowsmlserver">在Ubuntu 16.04 上部署微软机器学习服务器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/airflowdeploy">在 Ubuntu 18.04 上安装部署 Airflow 1.9.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/dockercommon">Docker常用命令笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/gitsubmodule">Git子项目的创建与克隆</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/wordautofurigana">自动为Word文档中的日文汉字注音(ふりがな)的VBA脚本</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/liaocy-net/docs/archieved/2018/07/ubuntuscws">07</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/liaocy-net/docs/archieved/2018/08/pythonlinuxwinpath">08</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/08/pythonlinuxwinpath">解决Python在Linux环境、Mac环境或Windows环境下，文件路径不同的问题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/liaocy-net/docs/archieved/2018/08/cryptozombiesio">cryptozombies.io Solidity 代码注释笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/08/phpmaxinputvars">调整PHP的POST数量限制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/08/phpstrcompare">相同的长字符串PHP比较结果不同的解决办法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/liaocy-net/docs/archieved/2018/08/blockchainheritage">用区块链和智能合约做遗产继承</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/liaocy-net/docs/archieved/2018/09/androidspeaker">09</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/liaocy-net/docs/archieved/2018/10/osrmlocalinstance">10</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/liaocy-net/docs/archieved/2018/12/apachewordpresspermalink404">12</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/liaocy-net/docs/archieved/2019/01/jupyterbreakpoint">2019</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/liaocy-net/docs/archieved/2020/03/raspi-vnc">2020</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/liaocy-net/docs/archieved/2021/08/pyguide">2021</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/liaocy-net/docs/archieved/awesome/cv">awesome</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/liaocy-net/docs/category/kubernetes">Kubernetes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/liaocy-net/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/liaocy-net/docs/category/archieved"><span itemprop="name">Archieved</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">2018</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">08</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">cryptozombies.io Solidity 代码注释笔记</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>cryptozombies.io Solidity 代码注释笔记</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="参考资料">参考资料<a class="hash-link" href="#参考资料" title="Direct link to heading">​</a></h2><p>本文用作 <a href="https://cryptozombies.io" target="_blank" rel="noopener noreferrer">https://cryptozombies.io</a> 中 Solidity 代码带注释的笔记</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="整理">整理<a class="hash-link" href="#整理" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="函数修饰符">函数修饰符<a class="hash-link" href="#函数修饰符" title="Direct link to heading">​</a></h3><table><thead><tr><th>修饰符</th><th>说明</th></tr></thead><tbody><tr><td>private</td><td>只能被合约内部调用</td></tr><tr><td>internal</td><td>就像 private 但是也能被继承的合约调用</td></tr><tr><td>external</td><td>只能从合约外部调用</td></tr><tr><td>public</td><td>可以在任何地方调用，不管是内部还是外部</td></tr><tr><td>view</td><td>告诉我们运行这个函数不会更改和保存任何数据</td></tr><tr><td>pure</td><td>告诉我们这个函数不但不会往区块链写数据，它甚至不从区块链读取数据。这两种在被从合约外部调用的时候都不花费任何gas（但是它们在被内部其他函数调用的时候将会耗费gas）</td></tr><tr><td>modifiers</td><td>自定义其对函数的约束逻辑</td></tr><tr><td>payable</td><td>可以接收以太的特殊函数</td></tr></tbody></table><p>修饰符可以同时作用于一个函数定义上</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="erc721-标准">ERC721 标准<a class="hash-link" href="#erc721-标准" title="Direct link to heading">​</a></h3><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract ERC721 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  event Transfer(address indexed _from, address indexed _to, uint256 _tokenId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  event Approval(address indexed _owner, address indexed _approved, uint256 _tokenId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function balanceOf(address _owner) public view returns (uint256 _balance);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function ownerOf(uint256 _tokenId) public view returns (address _owner);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function transfer(address _to, uint256 _tokenId) public;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function approve(address _to, uint256 _tokenId) public;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function takeOwnership(uint256 _tokenId) public;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="标准注释">标准注释<a class="hash-link" href="#标准注释" title="Direct link to heading">​</a></h3><p>Solidity 社区所使用的一个标准是使用一种被称作 natspec 的格式，看起来像这样：</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/// @title 一个简单的基础运算合约</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// @author H4XF13LD MORRIS 💯💯😎💯💯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// @notice 现在，这个合约只添加一个乘法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract Math {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /// @notice 两个数相乘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /// @param x 第一个 uint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /// @param y  第二个 uint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /// @return z  (x * y) 的结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /// @dev 现在这个方法不检查溢出</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function multiply(uint x, uint y) returns (uint z) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 这只是个普通的注释，不会被 natspec 解释</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    z = x * y;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>@title（标题） 和 @author （作者）很直接了.</p><p>@notice （须知）向 用户 解释这个方法或者合约是做什么的。 @dev （开发者） 是向开发者解释更多的细节。</p><p>@param （参数）和 @return （返回） 用来描述这个方法需要传入什么参数以及返回什么值。</p><p>注意你并不需要每次都用上所有的标签，它们都是可选的。不过最少，写下一个 @dev 注释来解释每个方法是做什么的。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="代码">代码<a class="hash-link" href="#代码" title="Direct link to heading">​</a></h2><p>zombiefactory.sol :</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.4.19;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract ZombieFactory {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event NewZombie(uint zombieId, string name, uint dna);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint dnaDigits = 16;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint dnaModulus = 10 ** dnaDigits;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    struct Zombie {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string name;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint dna;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Zombie[] public zombies;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping (uint =&gt; address) public zombieToOwner;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping (address =&gt; uint) ownerZombieCount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 除 public 和 private 属性之外，Solidity 还使用了另外两个描述函数可见性的修饰词：internal（内部） 和 external（外部）。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // internal 和 private 类似，不过， 如果某个合约继承自其父合约，这个合约即可以访问父合约中定义的“内部”函数。（嘿，这听起来正是我们想要的那样！）。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // external 与public 类似，只不过这些函数只能在合约之外调用 - 它们不能被合约内的其他函数调用。稍后我们将讨论什么时候使用 external 和 public。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 将 _createZombie() 函数的属性从 private 改为 internal ， 使得其他的合约也能访问到它。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //function _createZombie(string _name, uint _dna) private {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function _createZombie(string _name, uint _dna) internal { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint id = zombies.push(Zombie(_name, _dna)) - 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 在 Solidity 中，有一些全局变量可以被所有函数调用。 其中一个就是 msg.sender，它指的是当前调用者（或智能合约）的 address。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 首先，在得到新的僵尸 id 后，更新 zombieToOwner 映射，在 id 下面存入 msg.sender。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 然后，我们为这个 msg.sender 名下的 ownerZombieCount 加 1。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 如果Key不存在，该value默认为0，因此直接++就可以</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zombieToOwner[id] = msg.sender;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ownerZombieCount[msg.sender]++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        NewZombie(id, _name, _dna);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function _generateRandomDna(string _str) private view returns (uint) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint rand = uint(keccak256(_str));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return rand % dnaModulus;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function createRandomZombie(string _name) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // require使得函数在执行过程中，当不满足某些条件时抛出错误，并停止执行：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 敲黑板: Solidity 并不支持原生的字符串比较, 我们只能通过比较两字符串的 keccak256 哈希值来进行判断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 我们使用了 require 来确保这个函数只有在每个用户第一次调用它的时候执行，用以创建初始僵尸。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 在 createRandomZombie 的前面放置 require 语句。 使得函数先检查 ownerZombieCount [msg.sender] 的值为 0 ，不然就抛出一个错误。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(ownerZombieCount[msg.sender] == 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint randDna = _generateRandomDna(_name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _createZombie(_name, randDna);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>zombiefeeding.sol :</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 在 Solidity 中，当你有多个文件并且想把一个文件导入另一个文件时，可以使用 import 语句：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 将 zombiefactory.sol 导入到我们的新文件 zombiefeeding.sol 中。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;./zombiefactory.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//参考 CryptoKitties 源代码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//定义一个名为 KittyInterface 的接口。 请注意，因为我们使用了 contract 关键字， 这过程看起来就像创建一个新的合约一样。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract KittyInterface {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //在interface里定义了 getKitty 函数（不过是复制/粘贴上面的函数，但在 returns 语句之后用分号，而不是大括号内的所有内容。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getKitty(uint256 _id)external view returns (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bool isGestating,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bool isReady,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 cooldownIndex,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 nextActionAt,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 siringWithId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 birthTime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 matronId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 sireId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 generation,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 genes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 我们的游戏代码越来越长。 当代码过于冗长的时候，最好将代码和逻辑分拆到多个不同的合约中，以便于管理。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 有个让 Solidity 的代码易于管理的功能，就是合约 inheritance (继承)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 由于 子类 是从 父类 那里 inherits （继承)过来的。 这意味着当你编译和部署了 子类，它将可以访问我们在 父类 中定义的其他 **公共** 函数。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 在 ZombieFactory 下创建一个叫 ZombieFeeding 的合约，它是继承自 `ZombieFactory 合约的。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract ZombieFactory is ZombieFactory{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //我已经将代码中 CryptoKitties 合约的地址保存在一个名为 ckAddress 的变量中。在下一行中，请创建一个名为 kittyContract 的 KittyInterface，并用 ckAddress 为它初始化 —— 就像我们为 numberContract所做的一样。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address ckAddress = 0x06012c8cf97BEaD5deAe237070F9587f8E7A266d;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    KittyInterface kittyContract = KittyInterface(ckAddress);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 在 Solidity 中，有两个地方可以存储变量 —— storage 或 memory。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Storage 变量是指永久存储在区块链中的变量。 Memory 变量则是临时的，当外部函数对某合约调用完成时，内存型变量即被移除。 你可以把它想象成存储在你电脑的硬盘或是RAM中数据的关系。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 大多数时候你都用不到这些关键字，默认情况下 Solidity 会自动处理它们。 状态变量（在函数之外声明的变量）默认为“存储”形式，并永久写入区块链；而在函数内部声明的变量是“内存”型的，它们函数调用结束后消失。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 是时候给我们的僵尸增加“猎食”和“繁殖”功能了！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 当一个僵尸猎食其他生物体时，它自身的DNA将与猎物生物的DNA结合在一起，形成一个新的僵尸DNA。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 创建一个名为 feedAndMultiply 的函数。 使用两个参数：_zombieId（ uint类型 ）和_targetDna （也是 uint 类型）。 设置属性为 public 的。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // function feedAndMultiply(uint _zombieId, uint _targetDna) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 首先，我们修改下 feedAndMultiply 函数的定义，给它传入第三个参数：一条名为 _species 的字符串。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function feedAndMultiply(uint _zombieId, uint _targetDna, string _species) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 我们不希望别人用我们的僵尸去捕猎。 首先，我们确保对自己僵尸的所有权。 通过添加一个require 语句来确保 msg.sender 只能是这个僵尸的主人（类似于我们在 createRandomZombie 函数中做过的那样）。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(msg.sender == zombieToOwner[_zombieId]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //在我们计算出新的僵尸的DNA之后，添加一个 if 语句来比较 _species 和字符串 &quot;kitty&quot; 的 keccak256 哈希值。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (keccak256(_species) == keccak256(&quot;kitty&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 在 if 语句中，我们用 99 替换了新僵尸DNA的最后两位数字。可以这么做：newDna = newDna - newDna％100 + 99;。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 解释：假设 newDna 是 334455。那么 newDna％100 是 55，所以 newDna - newDna％100 得到 334400。最后加上 99 可得到 334499。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            newDna = newDna - newDna % 100 + 99;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //为了获取这个僵尸的DNA，我们的函数需要声明一个名为 myZombie 数据类型为Zombie的本地变量（这是一个 storage 型的指针）。 将其值设定为在 zombies 数组中索引为_zombieId所指向的值。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Zombie storage myZombie = zombies[_zombieId];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 获取新的僵尸DNA的公式很简单：计算猎食僵尸DNA和被猎僵尸DNA之间的平均值。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 首先我们确保 _targetDna 不长于16位。要做到这一点，我们可以设置 _targetDna 为 _targetDna％dnaModulus ，并且只取其最后16位数字。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _targetDna = _targetDna % dnaModulus;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 接下来为我们的函数声明一个名叫 newDna 的 uint类型的变量，并将其值设置为 myZombie的 DNA 和 _targetDna 的平均值（如上例所示）。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint newDna = (myZombie.dna + _targetDna) / 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 一旦我们计算出新的DNA，再调用 _createZombie 就可以生成新的僵尸了。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 注意：这段代码编译的时候编译器就会报错。 错误在于，我们尝试从 ZombieFeeding 中调用 _createZombie 函数，但 _createZombie 却是 ZombieFactory 的 private （私有）函数。这意味着任何继承自 ZombieFactory 的子合约都不能访问它。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _createZombie(&quot;NoName&quot;, newDna);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 参考 处理多返回值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 我们来定义一个函数，从 kitty 合约中获取它的基因：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 创建一个名为 feedOnKitty 的函数。它需要2个 uint 类型的参数，_zombieId 和_kittyId ，这是一个 public 类型的函数。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function feedOnKitty(uint _nombieId, uint _kittyId) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 函数首先要声明一个名为 kittyDna 的 uint。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 注意：在我们的 KittyInterface 中，genes 是一个 uint256 类型的变量，但是如果你记得，我们在第一课中提到过，uint 是 uint256 的别名，也就是说它们是一回事。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint kittyDna;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 这个函数接下来调用 kittyContract.getKitty函数, 传入 _kittyId ，将返回的 genes 存储在 kittyDna 中。记住 —— getKitty 会返回一大堆变量。 （确切地说10个 - 我已经为你数过了，不错吧！）。但是我们只关心最后一个-- genes。数逗号的时候小心点哦！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (,,,,,,,,,kittyDna) = kittyContract.getKitty(_kittyId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 最后，函数调用了 feedAndMultiply ，并传入了 _zombieId 和 kittyDna 两个参数。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //feedAndMultiply(_zombieId, kittyDna);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 最后，我们修改了 feedOnKitty 中的函数调用。当它调用 feedAndMultiply 时，增加 “kitty” 作为最后一个参数。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        feedAndMultiply(_zombieId, kittyDna, &quot;kitty&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例代码">示例代码<a class="hash-link" href="#示例代码" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="关于-storage-和-memory变量">关于 storage 和 memory变量：<a class="hash-link" href="#关于-storage-和-memory变量" title="Direct link to heading">​</a></h3><p>在 Solidity 中，有两个地方可以存储变量 —— storage 或 memory。</p><p>Storage 变量是指永久存储在区块链中的变量。 Memory 变量则是临时的，当外部函数对某合约调用完成时，内存型变量即被移除。 你可以把它想象成存储在你电脑的硬盘或是RAM中数据的关系。</p><p>Storage 类似一个指针，可以修改指向的变量。</p><p>大多数时候你都用不到这些关键字，默认情况下 Solidity 会自动处理它们。 状态变量（在函数之外声明的变量）默认为“存储”形式，并永久写入区块链；而在函数内部声明的变量是“内存”型的，它们函数调用结束后消失。</p><p>然而也有一些情况下，你需要手动声明存储类型，主要用于处理函数内的 结构体 和 数组 时：</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract SandwichFactory {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  struct Sandwich {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string name;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string status;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Sandwich[] sandwiches;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function eatSandwich(uint _index) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Sandwich mySandwich = sandwiches[_index];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ^ 看上去很直接，不过 Solidity 将会给出警告</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 告诉你应该明确在这里定义 `storage` 或者 `memory`。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 所以你应该明确定义 `storage`:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Sandwich storage mySandwich = sandwiches[_index];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...这样 `mySandwich` 是指向 `sandwiches[_index]`的指针</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 在存储里，另外...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mySandwich.status = &quot;Eaten!&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...这将永久把 `sandwiches[_index]` 变为区块链上的存储</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 如果你只想要一个副本，可以使用`memory`:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Sandwich memory anotherSandwich = sandwiches[_index + 1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...这样 `anotherSandwich` 就仅仅是一个内存里的副本了</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 另外</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    anotherSandwich.status = &quot;Eaten!&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...将仅仅修改临时变量，对 `sandwiches[_index + 1]` 没有任何影响</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 不过你可以这样做:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sandwiches[_index + 1] = anotherSandwich;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...如果你想把副本的改动保存回区块链存储</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="internal-和-external">internal 和 external：<a class="hash-link" href="#internal-和-external" title="Direct link to heading">​</a></h3><p>除 public 和 private 属性之外，Solidity 还使用了另外两个描述函数可见性的修饰词：internal（内部） 和 external（外部）。</p><p>internal 和 private 类似，不过， 如果某个合约继承自其父合约，这个合约即可以访问父合约中定义的“内部”函数。（嘿，这听起来正是我们想要的那样！）。</p><p>external 与public 类似，只不过这些函数只能在合约之外调用 - 它们不能被合约内的其他函数调用。稍后我们将讨论什么时候使用 external 和 public。</p><p>声明函数 internal 或 external 类型的语法，与声明 private 和 public类 型相同：</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract Sandwich {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint private sandwichesEaten = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function eat() internal {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sandwichesEaten++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract BLT is Sandwich {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint private baconSandwichesEaten = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function eatWithBacon() public returns (string) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    baconSandwichesEaten++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 因为eat() 是internal 的，所以我们能在这里调用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eat();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="与其他合约的交互">与其他合约的交互<a class="hash-link" href="#与其他合约的交互" title="Direct link to heading">​</a></h3><p>如果我们的合约需要和区块链上的其他的合约会话，则需先定义一个 interface (接口)。</p><p>先举一个简单的栗子。 假设在区块链上有这么一个合约：</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract LuckyNumber {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mapping(address =&gt; uint) numbers;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function setNum(uint _num) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    numbers[msg.sender] = _num;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function getNum(address _myAddress) public view returns (uint) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return numbers[_myAddress];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这是个很简单的合约，您可以用它存储自己的幸运号码，并将其与您的以太坊地址关联。 这样其他人就可以通过您的地址查找您的幸运号码了。</p><p>现在假设我们有一个外部合约，使用 getNum 函数可读取其中的数据。</p><p>首先，我们定义 LuckyNumber 合约的 interface ：</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract NumberInterface {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function getNum(address _myAddress) public view returns (uint);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，这个过程虽然看起来像在定义一个合约，但其实内里不同：</p><p>首先，我们只声明了要与之交互的函数 —— 在本例中为 getNum —— 在其中我们没有使用到任何其他的函数或状态变量。</p><p>其次，我们并没有使用大括号（{ 和 }）定义函数体，我们单单用分号（;）结束了函数声明。这使它看起来像一个合约框架。</p><p>编译器就是靠这些特征认出它是一个 <strong>接口</strong> 的。</p><p>在我们的 app 代码中使用这个接口，合约就知道其他合约的函数是怎样的，应该如何调用，以及可期待什么类型的返回值。</p><p>在下一课中，我们将真正调用其他合约的函数。目前我们只要声明一个接口，用于调用 CryptoKitties 合约就行了。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cryptokitties源代码">CryptoKitties源代码<a class="hash-link" href="#cryptokitties源代码" title="Direct link to heading">​</a></h3><p>我们已经为你查看过了 CryptoKitties 的源代码，并且找到了一个名为 getKitty的函数，它返回所有的加密猫的数据，包括它的“基因”（我们的僵尸游戏要用它生成新的僵尸）。</p><p>该函数如下所示：</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">function getKitty(uint256 _id) external view returns (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bool isGestating,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bool isReady,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 cooldownIndex,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 nextActionAt,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 siringWithId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 birthTime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 matronId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 sireId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 generation,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 genes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Kitty storage kit = kitties[_id];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // if this variable is 0 then it&#x27;s not gestating</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    isGestating = (kit.siringWithId != 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    isReady = (kit.cooldownEndBlock &lt;= block.number);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cooldownIndex = uint256(kit.cooldownIndex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nextActionAt = uint256(kit.cooldownEndBlock);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    siringWithId = uint256(kit.siringWithId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    birthTime = uint256(kit.birthTime);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matronId = uint256(kit.matronId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sireId = uint256(kit.sireId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    generation = uint256(kit.generation);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    genes = kit.genes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用接口">使用接口<a class="hash-link" href="#使用接口" title="Direct link to heading">​</a></h3><p>继续前面 NumberInterface 的例子，我们既然将接口定义为：</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract NumberInterface {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function getNum(address _myAddress) public view returns (uint);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们可以在合约中这样使用：</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract MyContract {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  address NumberInterfaceAddress = 0xab38...;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // ^ 这是FavoriteNumber合约在以太坊上的地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NumberInterface numberContract = NumberInterface(NumberInterfaceAddress);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 现在变量 `numberContract` 指向另一个合约对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function someFunction() public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 现在我们可以调用在那个合约中声明的 `getNum`函数:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint num = numberContract.getNum(msg.sender);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...在这儿使用 `num`变量做些什么</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>通过这种方式，只要将您合约的可见性设置为public(公共)或external(外部)，它们就可以与以太坊区块链上的任何其他合约进行交互。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="处理多返回值">处理多返回值<a class="hash-link" href="#处理多返回值" title="Direct link to heading">​</a></h3><p>getKitty 是我们所看到的第一个返回多个值的函数。我们来看看是如何处理的：</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">function multipleReturns() internal returns(uint a, uint b, uint c) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return (1, 2, 3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function processMultipleReturns() external {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint b;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 这样来做批量赋值:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (a, b, c) = multipleReturns();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 或者如果我们只想返回其中一个变量:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function getLastReturnValue() external {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 可以对其他字段留空:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (,,c) = multipleReturns();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kitty-和-web3js-放在一起">kitty 和 web3.js 放在一起<a class="hash-link" href="#kitty-和-web3js-放在一起" title="Direct link to heading">​</a></h3><p>我们只用编译和部署 ZombieFeeding，就可以将这个合约部署到以太坊了。我们最终完成的这个合约继承自 ZombieFactory，因此它可以访问自己和父辈合约中的所有 public 方法。</p><p>我们来看一个与我们的刚部署的合约进行交互的例子， 这个例子使用了 JavaScript 和 web3.js：</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> abi </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* abi generated by the compiler */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token maybe-class-name">ZombieFeedingContract</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">contract</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">abi</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> contractAddress </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* our contract address on Ethereum after deploying */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token maybe-class-name">ZombieFeeding</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">ZombieFeedingContract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">at</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">contractAddress</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 假设我们有我们的僵尸ID和要攻击的猫咪ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> zombieId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> kittyId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 要拿到猫咪的DNA，我们需要调用它的API。这些数据保存在它们的服务器上而不是区块链上。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 如果一切都在区块链上，我们就不用担心它们的服务器挂了，或者它们修改了API，</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 或者因为不喜欢我们的僵尸游戏而封杀了我们</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> apiUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://api.cryptokitties.co/kitties/&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> kittyId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">apiUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> imgUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">image_url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 一些显示图片的代码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 当用户点击一只猫咪的时候:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">$</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;.kittyImage&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">click</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 调用我们合约的 `feedOnKitty` 函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token maybe-class-name">ZombieFeeding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">feedOnKitty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">zombieId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kittyId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 侦听来自我们合约的新僵尸事件好来处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">ZombieFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">NewZombie</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 这个函数用来显示僵尸:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">generateZombie</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">zombieId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dna</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/liaocy-net/docs/tags/solidity">Solidity</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/liaocy-net/docs/tags/区块链-block-chain">区块链 Block Chain</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/liaocy-net/docs/tags/以太坊-ethereum-eth">以太坊 Ethereum (ETH)</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/liaocyintl/liaocy-net/tree/main/docs/archieved/2018/08/03-cryptozombiesio.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/liaocy-net/docs/archieved/2018/08/pythonlinuxwinpath"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">解决Python在Linux环境、Mac环境或Windows环境下，文件路径不同的问题</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/liaocy-net/docs/archieved/2018/08/phpmaxinputvars"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">调整PHP的POST数量限制</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#参考资料" class="table-of-contents__link toc-highlight">参考资料</a></li><li><a href="#整理" class="table-of-contents__link toc-highlight">整理</a><ul><li><a href="#函数修饰符" class="table-of-contents__link toc-highlight">函数修饰符</a></li><li><a href="#erc721-标准" class="table-of-contents__link toc-highlight">ERC721 标准</a></li><li><a href="#标准注释" class="table-of-contents__link toc-highlight">标准注释</a></li></ul></li><li><a href="#代码" class="table-of-contents__link toc-highlight">代码</a></li><li><a href="#示例代码" class="table-of-contents__link toc-highlight">示例代码</a><ul><li><a href="#关于-storage-和-memory变量" class="table-of-contents__link toc-highlight">关于 storage 和 memory变量：</a></li><li><a href="#internal-和-external" class="table-of-contents__link toc-highlight">internal 和 external：</a></li><li><a href="#与其他合约的交互" class="table-of-contents__link toc-highlight">与其他合约的交互</a></li><li><a href="#cryptokitties源代码" class="table-of-contents__link toc-highlight">CryptoKitties源代码</a></li><li><a href="#使用接口" class="table-of-contents__link toc-highlight">使用接口</a></li><li><a href="#处理多返回值" class="table-of-contents__link toc-highlight">处理多返回值</a></li><li><a href="#kitty-和-web3js-放在一起" class="table-of-contents__link toc-highlight">kitty 和 web3.js 放在一起</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/liaocy-net/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/liaocy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/liaocyintl" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/liaocy-net/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 liaocy.net. Built with Docusaurus.</div></div></div></footer></div>
<script src="/liaocy-net/assets/js/runtime~main.90d75dde.js"></script>
<script src="/liaocy-net/assets/js/main.83645087.js"></script>
</body>
</html>